<!DOCTYPE html>
<html>
<head>
  <!-- Site made with Mobirise Website Builder v4.7.2, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="service-worker">
  <meta name="generator" content="Mobirise v4.7.2, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="manifest" href="root/manifest.json">
  <link rel="shortcut icon" href="assets/images/logo2.png" type="image/x-icon">
  <meta name="description" content="">
  <title>Tiket Pemesanan</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">

    <meta charset='utf-8'/>
    <title>TIKET PEMESANAN</title>
    <style type='text/css'>     
        #pesan {
            border: 1px dashed #eee; padding: 10px;
            color: #808080; font-family: monospace;
        }
    </style>
    <link rel="stylesheet" href="css/materialize.css">
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/materialize.js"></script>
    
</head>
<body>
<section class="menu cid-qWOgSXHcEr" once="menu" id="menu1-e">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="#">
                         <img src="assets/images/logo2.png" alt="Mobirise" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap">
                    <a class="navbar-caption text-white display-4" href="index.html">
                        HOME
                    </a>
                </span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true">
                <li class="nav-item">
                    <a href="page3.html">
                        <span class="mbri-home mbr-iconfont mbr-iconfont-btn"></span>
                        TICKET
                    </a>
                </li>
       
                <li class="nav-item">
                    <a class="nav-link link text-white display-4" href="page2.html">
                        <span class="mbri-search mbr-iconfont mbr-iconfont-btn"></span>
                        About Us
                    </a>
                </li>
            </ul>
            
</section>
<section class="engine"><a href="page12.html">website templates</a></section><section class="cid-qWOgT1PUEy mbr-fullscreen mbr-parallax-background" id="header2-f">

  
  <div class="container">
   <div id="basic-form" class="section">
            <div class="row">
              <div class="col s12 m12 l5">
                <div class="card-panel">
                  <h6 class="header2" align="center">Jika anda merasa tertarik dengan wisata yang kami tawarkan anda dapat melakukan pemesanan tiket melalui message</h6>
                  <div class="row">
                    <form class="col s12" id='frmUtama'>
                      <div class="row">
                        <div class="input-field col s12">
                          <i class="mdi-action-picture-in-picture prefix"></i>
                          <input id="phone" name="phone" type="number" maxlength="7" required>
                          <label for="phone">Phone</label>
                        </div>
                      </div>
                      <div class="row">
                        <div class="input-field col s12">
                          <i class="mdi-action-account-box prefix"></i>
                          <input id="nama" name="nama" type="text" maxlength="50" required>
                          <label for="nama">Nama</label>
                        </div>
                      </div>
                      <div class="row">
                        <div class="input-field col s12">
                          <i class="mdi-action-account-box prefix"></i>
                          <input id="email" name="email" type="text" maxlength="50" required>
                          <label for="email">email</label>
                        </div>
                      </div>
                      <div class="row">
                        <div class="input-field col s12">
                          <i class="mdi-action-account-box prefix"></i>
                          <input id="message" name="message" type="text" maxlength="50" required>
                          <label for="message">message</label>
                        </div>
                      </div>
                  
                        <div class="row">
                          <div class="input-field col s12">
                              <button class="btn cyan waves-effect waves-light right" id='btnTambah' type="submit" value="Tambah">SEND MESSAGE</button>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
              <div class="col s12 m12 l7">
                  <div class="card-panel">
                  <table class="hoverable">
                        <thead>
                            <tr>
                                <th>PHONE</th>
                                <th>NAMA</th>
                                <th>email</th>
                                <th>message</th>
                                <th></th>
                            </tr>         
                        </thead>
                        <tbody id="tabel">
                        </tbody>
                    </table>
                </div>
            </div>
       </div>
       <div id='pesan'> </div>
      </div>
    </div>
    <script type="text/javascript">
        var tabel = document.getElementById('tabel'),
            phone = document.getElementById('phone'),
            nama = document.getElementById('nama'),
            email = document.getElementById('email'),
            btnTambah = document.getElementById('btnTambah'),
            form = document.getElementById('frmUtama'),
            pesan = document.getElementById('pesan'),
            message = document.getElementById('message'),
            db;         
 
        function tambahBaris(e) {
            // Periksa apakah NIM sudah ada
            if (tabel.rows.namedItem(phone.value)) {
                pesan.textContent = 'Error: Phone sudah terdaftar!';
                e.preventDefault();
                return;
            }
            // Tambah ke database
            tambahKeDatabase({
                phone: phone.value,
                nama: nama.value,
                email: email.value,
                message: message.value
            });
 
            // Membuat baris baru
            var baris = tabel.insertRow();
            baris.id = nim.value;
            baris.insertCell().appendChild(document.createTextNode(phone.value));
            baris.insertCell().appendChild(document.createTextNode(nama.value));
            baris.insertCell().appendChild(document.createTextNode(email.value));
            baris.insertCell().appendChild(document.createTextNode(message.value));
 
            // Membuat tombol hapus untuk setiap baris
            var btnHapus = document.createElement('input');
            btnHapus.type = 'button';
            btnHapus.value = 'Hapus';
            btnHapus.id = phone.value;            
            baris.insertCell().appendChild(btnHapus);
 
            e.preventDefault();
        }               
 
        function hapusBaris(e) {
            if (e.target.type=='button') {                
                tabel.deleteRow(tabel.rows.namedItem(e.target.id).sectionRowIndex);
                hapusDariDatabase(e.target.id);
            }
        }
 
        form.addEventListener('submit', tambahBaris, false);                  
        tabel.addEventListener('click', hapusBaris, true);            
        function kesalahanHandler(e) {
        pesan.innerHTML += 'Kesalahan Database: ' + e.target.errorCode + '<br>';      
        }
    
        function buatDatabase() {
            var request = window.indexedDB.open('pemesanan', 1);
            request.onerror = kesalahanHandler;
            request.onupgradeneeded = function(e) {             
                var db = e.target.result;
                db.onerror = kesalahanHandler;                          
                var objectstore = db.createObjectStore('datapesan', { keyPath: 'phone' });
               
            }
            request.onsuccess = function(e) {           
                db = e.target.result;
                db.onerror = kesalahanHandler;                          
                
                bacaDariDatabase();
            }
        }

        buatDatabase();
        
        function cetakPesanHandler(msg) {
            return function(e) {
                pesan.innerHTML += msg + '<br>';
            }
        }
 
        function buatTransaksi() {
            var transaction = db.transaction(['datapesan'], 'readwrite');
            transaction.onerror = kesalahanHandler;
            transaction.oncomplete = cetakPesanHandler('Transaksi baru saja diselesaikan.');                  
            return transaction;
        }

        function tambahKeDatabase(datapesan) {      
            var objectstore = buatTransaksi().objectStore('datapesan');
            var request = objectstore.add(datapesan);
            request.onerror = kesalahanHandler;
            request.onsuccess = cetakPesanHandler('datapesan [' + datapesan.phoe + '] telah ditambahkan ke database lokal.');            
        }
        
        // Menampilkan dari database
        function bacaDariDatabase() {
            var objectstore = buatTransaksi().objectStore('datapesan');
            objectstore.openCursor().onsuccess = function(e) {
                var result = e.target.result;
                if (result) {
                    pesan.innerHTML += 'Membaca mahasiswa [' + result.value.phone + '] dari database.<br>';
                    var baris = tabel.insertRow();                  
                    baris.id = result.value.phone;
                    baris.insertCell().appendChild(document.createTextNode(result.value.phone));
                    baris.insertCell().appendChild(document.createTextNode(result.value.nama));
                    baris.insertCell().appendChild(document.createTextNode(result.value.email));
                    baris.insertCell().appendChild(document.createTextNode(result.value.message));
                    var btnHapus = document.createElement('input');
                    btnHapus.type = 'button';
                    btnHapus.value = 'Hapus';
                    btnHapus.id = result.value.phone;         
                    baris.insertCell().appendChild(btnHapus);
                    result.continue();
                }
            }   
        }
        
        // Hapus dari database
        function hapusDariDatabase(nim) {
            var objectstore = buatTransaksi().objectStore('datapesan');
            var request = objectstore.delete(phone);
            request.onerror = kesalahanHandler;
            request.onsuccess = cetakPesanHandler('Mahasiswa [' + phone + '] berhasil dihapus dari database lokal.');
        }
    </script>

    
  <script>
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('service-worker.js')
          .then(function(registration) {
            console.log('Registered:', registration);
          })
          .catch(function(error) {
            console.log('Registration failed: ', error);
          });
        }
        </script>
  
 
</body>
</html>